(executable
 (name main1)
 (public_name main1)
 ;; (modules)
 (flags (:standard -open Foo
                   -linkall))
 (link_flags -link_flag_a)
 (libraries Foo)
 (ocamlc_flags -compile_flag_vm)
 (ocamlopt_flags -compile_flag_opt)
 )

;; NB: main2 and main3 have the same prologue, so they must match on
;; all the other flds as well, otherwise B would need to be compiled
;; twice.  We do not validate the stanzas, though; that's Dune's job.

(executable
 (name main2)
 (public_name main2)
 (modules) ;; B)
 (flags (:standard -open Bar
                   -linkall))
 (link_flags -link_flag_b)
 (libraries Bar)
 (ocamlc_flags -compile_flag_vm)
 (ocamlopt_flags -compile_flag_opt)
 )

(executable
 (name main3)
 (public_name main3)
 (modules B)
 (flags (:standard -open Bar
                   -linkall))
 (link_flags -link_flag_b)
 (libraries Bar)
 (ocamlc_flags -compile_flag_vm)
 (ocamlopt_flags -compile_flag_opt)
 )
